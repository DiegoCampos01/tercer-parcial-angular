import{Ib as m,J as n,M as c,h as e,k as s,n as l}from"./chunk-T7TK6TUY.js";var p=class u{constructor(a){this.http=a;let t=localStorage.getItem("usuario_actual");t&&this.usuarioActualSubject.next(JSON.parse(t))}apiUrl="http://localhost:3001/usuarios";usuarioActualSubject=new e(null);usuarioActual$=this.usuarioActualSubject.asObservable();TEST_USERS={admin:{id:1,nombre:"Administrador",email:"admin@admin.com",password:"admin123",rol:"admin",activo:!0},user:{id:2,nombre:"Usuario Regular",email:"usuario@usuario.com",password:"user123",rol:"usuario",activo:!0}};login(a,t){let i=Object.values(this.TEST_USERS).find(o=>o.email===a&&o.password===t);return i?(localStorage.setItem("usuario_actual",JSON.stringify(i)),this.usuarioActualSubject.next(i),s(i)):this.http.get(`${this.apiUrl}?email=${a}`).pipe(l(o=>{let r=o[0];if(r&&r.password===t&&r.activo)return localStorage.setItem("usuario_actual",JSON.stringify(r)),this.usuarioActualSubject.next(r),r;throw new Error("Credenciales inv\xE1lidas")}))}logout(){localStorage.removeItem("usuario_actual"),this.usuarioActualSubject.next(null)}isAdmin(){return this.usuarioActualSubject.value?.rol==="admin"||!1}isLoggedIn(){return this.usuarioActualSubject.value!==null}getUsuarioActual(){return this.usuarioActualSubject.value}static \u0275fac=function(t){return new(t||u)(c(m))};static \u0275prov=n({token:u,factory:u.\u0275fac,providedIn:"root"})};export{p as a};
